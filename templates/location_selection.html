<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Î≥ëÏõê ÏßÄÏó≠ ÏÑ†ÌÉù</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <style>
        :root {
            --primary-color: #2a60ff;
            --button-color: #2a60ff;
            --button-hover: #1e4cd6;
            --selected-color: #1e4cd6;
        }
        .body {
            background-color: #acbfd2;
        }
        .navbar-brand {
            color: var(--primary-color) !important;
            font-weight: bold;
        }

        .nav-link {
            color: #333 !important;
            transition: color 0.3s ease;
        }

        .nav-link:hover, .nav-link.active {
            color: var(--primary-color) !important;
        }

        .section {
            background-color: #ffffff;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            overflow-y: auto;
            height: 600px;
        }

        .city-buttons, .district-buttons {
            display: grid;
            gap: 12px;
        }

        .city-buttons {
            grid-template-columns: repeat(2, 1fr);
        }

        .district-buttons {
            grid-template-columns: repeat(3, 1fr);
        }

        .button {
            padding: 12px;
            font-size: 14px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            background-color: var(--button-color);
            color: white;
            text-align: center;
            transition: all 0.3s ease;
        }

        .button.selected {
            background-color: var(--selected-color);
            transform: scale(0.98);
        }

        .button:hover {
            background-color: var(--button-hover);
            transform: translateY(-2px);
        }

        .dropdown {
            margin-top: 10px;
            width: 100%;
            padding: 12px;
            font-size: 14px;
            border-radius: 8px;
            border: 1px solid #ddd;
        }

        #search-button {
            margin-top: 20px;
            width: 100%;
            background-color: var(--button-color);
            border: none;
            padding: 12px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        #search-button:hover {
            background-color: var(--button-hover);
        }

        .hospital-item {
            padding: 20px;
            border-radius: 8px;
            background-color: #f8f9fa;
            margin-bottom: 15px;
            transition: all 0.3s ease;
        }

        .hospital-item:hover {
            transform: translateX(5px);
            background-color: #f0f4ff;
        }

        .hospital-name {
            color: var(--primary-color);
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .hospital-address {
            color: #666;
            margin-bottom: 5px;
        }

        .hospital-phone {
            color: #888;
            font-size: 14px;
        }

        .pagination-buttons {
            margin-top: 20px;
            display: flex;
            justify-content: center;
            gap: 10px;
        }

        .pagination-buttons button {
            padding: 8px 20px;
            border: none;
            border-radius: 6px;
            background-color: var(--button-color);
            color: white;
            transition: all 0.3s ease;
        }

        .pagination-buttons button:hover {
            background-color: var(--button-hover);
        }

        .pagination-buttons button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
    </style>
</head>
<body class="bg-light">
    <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm">
        <div class="container-fluid">
            <a class="navbar-brand" href="/">AI Ìó¨Ïä§ÏºÄÏñ¥</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link {% if request.path == '/' %}active{% endif %}" href="/">Ìôà</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link {% if request.path == '/location_selection' %}active{% endif %}" href="/location_selection">Î≥ëÏõê Í≤ÄÏÉâ</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link {% if request.path == '/drug_information' %}active{% endif %}" href="/drug_information">ÏùòÏïΩÌíà Ï†ïÎ≥¥</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container my-4">
        <div class="row">
            <div class="col-md-4 mb-4">
                <div class="section">
                    <h5 class="mb-3">ÎèÑÏãú ÏÑ†ÌÉù</h5>
                    <div id="city-buttons" class="city-buttons">
                        <!-- ÎèÑÏãú Î≤ÑÌäºÏù¥ ÎèôÏ†ÅÏúºÎ°ú Ï∂îÍ∞ÄÎê©ÎãàÎã§ -->
                    </div>
                </div>
            </div>

            <div class="col-md-4 mb-4">
                <div class="section">
                    <h5 class="mb-3">Ïãú/Íµ∞/Íµ¨ ÏÑ†ÌÉù</h5>
                    <div id="district-buttons" class="district-buttons">
                        <!-- ÏßÄÏó≠Íµ¨ Î≤ÑÌäºÏù¥ ÎèôÏ†ÅÏúºÎ°ú Ï∂îÍ∞ÄÎê©ÎãàÎã§ -->
                    </div>
                </div>
            </div>

            <div class="col-md-4 mb-4">
                <div class="section">
                    <h5 class="mb-3">ÏßÑÎ£åÍ≥ºÎ™© ÏÑ†ÌÉù</h5>
                    <select id="department-dropdown" name="selected_department" class="form-select">
                        {% for department, code in all_departments.items() %}
                            <option value="{{ department }}">{{ department }}</option>
                        {% endfor %}
                    </select>
                    <button id="search-button" class="btn btn-primary">Î≥ëÏõê Í≤ÄÏÉâ</button>
                </div>
            </div>
        </div>

        <div id="result" class="section mt-4">
            <h5 class="mb-4">Î≥ëÏõê Î™©Î°ù</h5>
            <div id="hospital-list"></div>
            <div class="pagination-buttons">
                <button id="prev-button" class="btn btn-secondary">Ïù¥Ï†Ñ</button>
                <button id="next-button" class="btn btn-secondary">Îã§Ïùå</button>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
    <script>
        const districtData = {
            "ÏÑúÏö∏ÌäπÎ≥ÑÏãú": ["Ï¢ÖÎ°úÍµ¨", "Ï§ëÍµ¨", "Ïö©ÏÇ∞Íµ¨", "ÏÑ±ÎèôÍµ¨", "Í¥ëÏßÑÍµ¨", "ÎèôÎåÄÎ¨∏Íµ¨", "Ï§ëÎûëÍµ¨", "ÏÑ±Î∂ÅÍµ¨",
                         "Í∞ïÎ∂ÅÍµ¨", "ÎèÑÎ¥âÍµ¨", "ÎÖ∏ÏõêÍµ¨", "ÏùÄÌèâÍµ¨", "ÏÑúÎåÄÎ¨∏Íµ¨", "ÎßàÌè¨Íµ¨", "ÏñëÏ≤úÍµ¨", "Í∞ïÏÑúÍµ¨", 
                         "Íµ¨Î°úÍµ¨", "Í∏àÏ≤úÍµ¨", "ÏòÅÎì±Ìè¨Íµ¨", "ÎèôÏûëÍµ¨", "Í¥ÄÏïÖÍµ¨", "ÏÑúÏ¥àÍµ¨", "Í∞ïÎÇ®Íµ¨", "ÏÜ°ÌååÍµ¨", "Í∞ïÎèôÍµ¨"],
            "Î∂ÄÏÇ∞Í¥ëÏó≠Ïãú": ["Ï§ëÍµ¨", "ÏÑúÍµ¨", "ÎèôÍµ¨", "ÏòÅÎèÑÍµ¨", "Î∂ÄÏÇ∞ÏßÑÍµ¨", "ÎèôÎûòÍµ¨", "ÎÇ®Íµ¨", "Î∂ÅÍµ¨", "Ìï¥Ïö¥ÎåÄÍµ¨", 
                        "ÏÇ¨ÌïòÍµ¨", "Í∏àÏ†ïÍµ¨", "Í∞ïÏÑúÍµ¨", "Ïó∞Ï†úÍµ¨", "ÏàòÏòÅÍµ¨", "ÏÇ¨ÏÉÅÍµ¨", "Í∏∞Ïû•Íµ∞"],
            "ÎåÄÍµ¨Í¥ëÏó≠Ïãú": ["Ï§ëÍµ¨", "ÎèôÍµ¨", "ÏÑúÍµ¨", "ÎÇ®Íµ¨", "Î∂ÅÍµ¨", "ÏàòÏÑ±Íµ¨", "Îã¨ÏÑúÍµ¨", "Îã¨ÏÑ±Íµ∞", "Íµ∞ÏúÑÍµ∞"],
            "Ïù∏Ï≤úÍ¥ëÏó≠Ïãú": ["Ï§ëÍµ¨", "ÎèôÍµ¨", "ÎØ∏Ï∂îÌôÄÍµ¨", "Ïó∞ÏàòÍµ¨", "ÎÇ®ÎèôÍµ¨", "Î∂ÄÌèâÍµ¨", "Í≥ÑÏñëÍµ¨", "ÏÑúÍµ¨", "Í∞ïÌôîÍµ∞", "ÏòπÏßÑÍµ∞"],
            "Í¥ëÏ£ºÍ¥ëÏó≠Ïãú": ["ÎèôÍµ¨", "ÏÑúÍµ¨", "ÎÇ®Íµ¨", "Î∂ÅÍµ¨", "Í¥ëÏÇ∞Íµ¨"],
            "ÎåÄÏ†ÑÍ¥ëÏó≠Ïãú": ["ÎèôÍµ¨", "Ï§ëÍµ¨", "ÏÑúÍµ¨", "Ïú†ÏÑ±Íµ¨", "ÎåÄÎçïÍµ¨"],
            "Ïö∏ÏÇ∞Í¥ëÏó≠Ïãú": ["Ï§ëÍµ¨", "ÎÇ®Íµ¨", "ÎèôÍµ¨", "Î∂ÅÍµ¨", "Ïö∏Ï£ºÍµ∞"],
            "ÏÑ∏Ï¢ÖÌäπÎ≥ÑÏûêÏπòÏãú": ["ÏÑ∏Ï¢ÖÌäπÎ≥ÑÏûêÏπòÏãú"],
            "Í≤ΩÍ∏∞ÎèÑ": ["ÏàòÏõêÏãú", "Ïö©Ïù∏Ïãú", "Í≥†ÏñëÏãú", "ÌôîÏÑ±Ïãú", "ÏÑ±ÎÇ®Ïãú", "Î∂ÄÏ≤úÏãú", "ÎÇ®ÏñëÏ£ºÏãú", "ÏïàÏÇ∞Ïãú", "ÌèâÌÉùÏãú", 
                    "ÏïàÏñëÏãú", "ÏãúÌù•Ïãú", "ÌååÏ£ºÏãú", "ÍπÄÌè¨Ïãú", "ÏùòÏ†ïÎ∂ÄÏãú", "Í¥ëÏ£ºÏãú", "ÌïòÎÇ®Ïãú", "Í¥ëÎ™ÖÏãú", "Íµ∞Ìè¨Ïãú", "ÏñëÏ£ºÏãú", 
                    "Ïò§ÏÇ∞Ïãú", "Ïù¥Ï≤úÏãú", "ÏïàÏÑ±Ïãú", "Íµ¨Î¶¨Ïãú", "ÏùòÏôïÏãú", "Ìè¨Ï≤úÏãú", "ÏñëÌèâÍµ∞", "Ïó¨Ï£ºÏãú", "ÎèôÎëêÏ≤úÏãú", "Í≥ºÏ≤úÏãú", "Í∞ÄÌèâÍµ∞", "Ïó∞Ï≤úÍµ∞"],
            "Í∞ïÏõêÌäπÎ≥ÑÏûêÏπòÎèÑ": ["Ï∂òÏ≤úÏãú", "ÏõêÏ£ºÏãú", "Í∞ïÎ¶âÏãú", "ÎèôÌï¥Ïãú", "ÌÉúÎ∞±Ïãú", "ÏÜçÏ¥àÏãú", "ÏÇºÏ≤ôÏãú", "ÌôçÏ≤úÍµ∞", "Ìö°ÏÑ±Íµ∞", 
                            "ÏòÅÏõîÍµ∞", "ÌèâÏ∞ΩÍµ∞", "Ï†ïÏÑ†Íµ∞", "Ï≤†ÏõêÍµ∞", "ÌôîÏ≤úÍµ∞", "ÏñëÍµ¨Íµ∞", "Ïù∏Ï†úÍµ∞", "Í≥†ÏÑ±Íµ∞", "ÏñëÏñëÍµ∞"],
            "Ï∂©Ï≤≠Î∂ÅÎèÑ": ["Ï≤≠Ï£ºÏãú", "Ï∂©Ï£ºÏãú", "Ï†úÏ≤úÏãú", "Î≥¥ÏùÄÍµ∞", "Ïò•Ï≤úÍµ∞", "ÏòÅÎèôÍµ∞", "Ï¶ùÌèâÍµ∞", "ÏßÑÏ≤úÍµ∞", "Í¥¥ÏÇ∞Íµ∞", "ÏùåÏÑ±Íµ∞", "Îã®ÏñëÍµ∞"],
            "Ï∂©Ï≤≠ÎÇ®ÎèÑ": ["Ï≤úÏïàÏãú", "Í≥µÏ£ºÏãú", "Î≥¥Î†πÏãú", "ÏïÑÏÇ∞Ïãú", "ÏÑúÏÇ∞Ïãú", "ÎÖºÏÇ∞Ïãú", "Í≥ÑÎ£°Ïãú", "ÎãπÏßÑÏãú", "Í∏àÏÇ∞Íµ∞", "Î∂ÄÏó¨Íµ∞", "ÏÑúÏ≤úÍµ∞", 
                        "Ï≤≠ÏñëÍµ∞", "ÌôçÏÑ±Íµ∞", "ÏòàÏÇ∞Íµ∞", "ÌÉúÏïàÍµ∞"],
            "Ï†ÑÎ∂ÅÌäπÎ≥ÑÏûêÏπòÎèÑ": ["Ï†ÑÏ£ºÏãú", "Íµ∞ÏÇ∞Ïãú", "ÏùµÏÇ∞Ïãú", "Ï†ïÏùçÏãú", "ÎÇ®ÏõêÏãú", "ÍπÄÏ†úÏãú", "ÏôÑÏ£ºÍµ∞", "ÏßÑÏïàÍµ∞", "Î¨¥Ï£ºÍµ∞", "Ïû•ÏàòÍµ∞", 
                            "ÏûÑÏã§Íµ∞", "ÏàúÏ∞ΩÍµ∞", "Í≥†Ï∞ΩÍµ∞", "Î∂ÄÏïàÍµ∞"],
            "Ï†ÑÎùºÎÇ®ÎèÑ": ["Î™©Ìè¨Ïãú", "Ïó¨ÏàòÏãú", "ÏàúÏ≤úÏãú", "ÎÇòÏ£ºÏãú", "Í¥ëÏñëÏãú", "Îã¥ÏñëÍµ∞", "Í≥°ÏÑ±Íµ∞", "Íµ¨Î°ÄÍµ∞", "Í≥†Ìù•Íµ∞", "Î≥¥ÏÑ±Íµ∞", "ÌôîÏàúÍµ∞", 
                        "Ïû•Ìù•Íµ∞", "Í∞ïÏßÑÍµ∞", "Ìï¥ÎÇ®Íµ∞", "ÏòÅÏïîÍµ∞", "Î¨¥ÏïàÍµ∞", "Ìï®ÌèâÍµ∞", "ÏòÅÍ¥ëÍµ∞", "Ïû•ÏÑ±Íµ∞", "ÏôÑÎèÑÍµ∞", "ÏßÑÎèÑÍµ∞", "Ïã†ÏïàÍµ∞"],
            "Í≤ΩÏÉÅÎ∂ÅÎèÑ": ["Ìè¨Ìï≠Ïãú", "Í≤ΩÏ£ºÏãú", "ÍπÄÏ≤úÏãú", "ÏïàÎèôÏãú", "Íµ¨ÎØ∏Ïãú", "ÏòÅÏ£ºÏãú", "ÏòÅÏ≤úÏãú", "ÏÉÅÏ£ºÏãú", "Î¨∏Í≤ΩÏãú", "Í≤ΩÏÇ∞Ïãú", "ÏùòÏÑ±Íµ∞", 
                        "Ï≤≠ÏÜ°Íµ∞", "ÏòÅÏñëÍµ∞", "ÏòÅÎçïÍµ∞", "Ï≤≠ÎèÑÍµ∞", "Í≥†Î†πÍµ∞", "ÏÑ±Ï£ºÍµ∞", "Ïπ†Í≥°Íµ∞", "ÏòàÏ≤úÍµ∞", "Î¥âÌôîÍµ∞", "Ïö∏ÏßÑÍµ∞", "Ïö∏Î¶âÍµ∞"],
            "Í≤ΩÏÉÅÎÇ®ÎèÑ": ["Ï∞ΩÏõêÏãú", "ÏßÑÏ£ºÏãú", "ÌÜµÏòÅÏãú", "ÏÇ¨Ï≤úÏãú", "ÍπÄÌï¥Ïãú", "Î∞ÄÏñëÏãú", "Í±∞Ï†úÏãú", "ÏñëÏÇ∞Ïãú", "ÏùòÎ†πÍµ∞", "Ìï®ÏïàÍµ∞", "Ï∞ΩÎÖïÍµ∞", 
                        "Í≥†ÏÑ±Íµ∞", "ÎÇ®Ìï¥Íµ∞", "ÌïòÎèôÍµ∞", "ÏÇ∞Ï≤≠Íµ∞", "Ìï®ÏñëÍµ∞", "Í±∞Ï∞ΩÍµ∞", "Ìï©Ï≤úÍµ∞"],
            "Ï†úÏ£ºÌäπÎ≥ÑÏûêÏπòÎèÑ": ["Ï†úÏ£ºÏãú", "ÏÑúÍ∑ÄÌè¨Ïãú"]
        };
        let selectedCity = "";
        let selectedDistrict = "";
        let currentPage = 1;

        const cityButtons = document.getElementById("city-buttons");
        Object.keys(districtData).forEach(city => {
            const button = document.createElement("button");
            button.classList.add("button");
            button.textContent = city;
            button.onclick = () => {
                selectedCity = city;
                document.querySelectorAll("#city-buttons .button").forEach(btn => btn.classList.remove("selected"));
                button.classList.add("selected");
                showDistrictButtons(city);
            };
            cityButtons.appendChild(button);
        });

        const showDistrictButtons = (city) => {
            const districtButtons = document.getElementById("district-buttons");
            districtButtons.innerHTML = "";
            districtData[city].forEach(district => {
                const button = document.createElement("button");
                button.classList.add("button");
                button.textContent = district;
                button.onclick = () => {
                    selectedDistrict = district;
                    document.querySelectorAll("#district-buttons .button").forEach(btn => btn.classList.remove("selected"));
                    button.classList.add("selected");
                };
                districtButtons.appendChild(button);
            });
        };

        const formatHospitalData = (hospitalString) => {
            const hospitals = hospitalString.split('\n').filter(line => line.trim() !== '');
            return hospitals.map(hospital => {
                const [name, location] = hospital.split(', Ï£ºÏÜå: ');
                const [address, phone] = location ? location.split(', ‚òé: ') : ['', ''];
                return {
                    name: name.replace('Î≥ëÏõêÎ™Ö: ', ''),
                    address: address,
                    phone: phone
                };
            });
        };

        const fetchHospitals = () => {
            const department = document.getElementById("department-dropdown").value;
            if (!selectedCity || !selectedDistrict || !department) {
                alert("Î™®Îì† Ìï≠Î™©ÏùÑ ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî!");
                return;
            }

            fetch("/recommend", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    city: selectedCity,
                    district: selectedDistrict,
                    medical_department: department,
                    pageNo: currentPage
                })
            })
            .then(response => response.json())
            .then(data => {
                const resultDiv = document.getElementById("hospital-list");
                const hospitals = formatHospitalData(data.response);
                const hospitalListHTML = hospitals.map(hospital => `
                    <div class="hospital-item">
                        <div class="hospital-name">${hospital.name}</div>
                        <div class="hospital-address">üìç ${hospital.address}</div>
                        <div class="hospital-phone">üìû ${hospital.phone}</div>
                    </div>
                `).join('');
                resultDiv.innerHTML = hospitalListHTML;

                // ÌéòÏù¥ÏßÄ Î≤ÑÌäº ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
                document.getElementById("prev-button").disabled = currentPage === 1;
                document.getElementById("next-button").disabled = hospitals.length === 0;
            })
            .catch(error => {
                console.error("Error:", error);
                alert("Î≥ëÏõê Í≤ÄÏÉâ Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.");
            });
        };

        document.getElementById("search-button").addEventListener("click", () => {
            currentPage = 1;
            fetchHospitals();
        });

        document.getElementById("prev-button").addEventListener("click", () => {
            if (currentPage > 1) {
                currentPage--;
                fetchHospitals();
            }
        });

        document.getElementById("next-button").addEventListener("click", () => {
            currentPage++;
            fetchHospitals();
        });
        </script>
    </body>
</html>